/**
 * Sample React Native App
 *
 * adapted from App.js generated by the following command:
 *
 * react-native init example
 *
 * https://github.com/facebook/react-native
 *
 * @format
 * @flow strict-local
 */

import React, {Node, useState} from 'react';
import {
  SafeAreaView,
  ScrollView,
  StatusBar,
  Text,
  TextInput,
  useColorScheme,
  View,
} from 'react-native';
import {Colors} from 'react-native/Libraries/NewAppScreen';
import PaymentsContainer from './src/payments/PaymentsContainer';
import styles from './src/Styles';
import testProps from './src/TestProps';

const App: () => Node = () => {
  const [clientToken, setClientToken] = useState(authToken);

  const isDarkMode = useColorScheme() === 'dark';

  const backgroundStyle = {
    backgroundColor: isDarkMode ? Colors.darker : Colors.lighter,
  };

  const renderSetTokenInput = () => {
    if (clientToken === '') {
      return (
        <TextInput
          style={styles.tokenInput}
          placeholder="Set token here..."
          multiline={true}
          blurOnSubmit={true}
          {...testProps('setTokenInput')}
          onChangeText={text => {
            setClientToken(text);
          }}
        />
      );
    }
  };

  return (
    <SafeAreaView style={backgroundStyle}>
      <StatusBar barStyle={isDarkMode ? 'light-content' : 'dark-content'} />
      <ScrollView
        contentInsetAdjustmentBehavior="automatic"
        style={backgroundStyle}>
        <View
          style={{
            backgroundColor: isDarkMode ? Colors.black : Colors.white,
          }}>
          <Text style={styles.header}>â˜†Klarna Payments Test App</Text>
          {renderSetTokenInput()}
          {paymentMethods.map(paymentMethod => {
            return (
              <PaymentsContainer
                clientToken={clientToken}
                paymentMethodName={paymentMethod}
              />
            );
          })}
        </View>
      </ScrollView>
    </SafeAreaView>
  );
};

let authToken = ''; // set your token here

const paymentMethods = [
  'pay_now',
  'pay_later',
  'pay_over_time',
  'pay_in_parts',
];

export default App;
